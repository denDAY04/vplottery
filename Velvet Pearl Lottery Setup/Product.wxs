<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  <Product Id="*" Name="Velvet Pearl Lottery" Language="1033" Version="1.0.0.0" Manufacturer="Velvet Pearl" UpgradeCode="752460f2-f6ae-4729-a46b-1e38244d795a">
	  <Package Keywords="Installer" InstallerVersion="200" Compressed="yes" Description="Velvet Pearl Lottery 1.0.0 Installer" InstallScope="perMachine" />

     
		<MajorUpgrade DowngradeErrorMessage="A newer version of Velvet Pearl Lottery is already installed." />
		<MediaTemplate EmbedCab="yes"/>

		<Feature Id="Complete" Title="Velvet Pearl Lottery" 
             Description="The complete package." 
             Display="expand" 
             Level="1" 
             ConfigurableDirectory="INSTALLDIR"
             AllowAdvertise="no"    
             InstallDefault="local"
             Absent="disallow">
      <Feature Id="MainProgram" Title="Program" 
               Description="The main executable, containing both the graphical user interface, data models." 
               Level="1">
			  <ComponentRef Id="MainExecutable" />
        <ComponentRef Id="DatafileIcon"/>
        <ComponentRef Id="ProgramIcon"/>
        <ComponentRef Id="Readme"/>
        <ComponentRef Id="License"/>
        <ComponentRef Id="ProgramMenuDir" />
      </Feature>    
		</Feature>

    <Icon Id="ApplicationIcon.exe" SourceFile="resources\vpl_program.ico"/>
    <Icon Id="ApplicationIcon.ico" SourceFile="resources\vpl_program.ico"/>
    
    <!--Set icon appearing in Windows Control Panel -> Add/Remove Programs--> 
    <Icon Id="DatafileIcon.ico" SourceFile="resources\velvet_pearl_lottery_file.ico"/>
    <Property Id="ARPPRODUCTICON" Value="ApplicationIcon.ico"/>
    
    <!--GUI references - use minimum while allowing for custom install path-->
    <UIRef Id="WixUI_InstallDir"/>
    <UIRef Id="WixUI_ErrorProgressText"/>
    <Property Id="WIXUI_INSTALLDIR" Value="INSTALLDIR"/>
    <WixVariable Id="WixUILicenseRtf" Value="resources\license.rtf"/>
    
    <!--Windows 7 or bigger, conditon-->
    <Condition Message="The application can only be installed on Windows 7 or newer">VersionNT >= 601</Condition>
  </Product>

	<Fragment>
		<Directory Id="TARGETDIR" Name="SourceDir">
			
      <Directory Id="ProgramFilesFolder">
        <Directory Id="VelvetPearlDir" Name="Velvet Pearl">
				  <Directory Id="INSTALLDIR" Name="Velvet Pearl Lottery" />

          <!--Resource directory-->          
          <Directory Id="ResourceDir" Name="Resources">
            <!--Icon for data (.vplf) files-->
            <Component Id="DatafileIcon" Guid="*">           
              <File Id="DatafileIconVPLF" Name="vplf.ico" Source="resources\velvet_pearl_lottery_file.ico" />
            </Component>  
            <!--Icon for exe-->
            <Component Id="ProgramIcon" Guid="*">
              <File Id="ProgramIconEXE" Name="Velvet Pearl Lottery.ico" Source="resources\vpl_program.ico"/>
            </Component>
          </Directory>                    

          <!--Main program/executable-->
          <Component Id="MainExecutable" Guid="*">
            <!--Executable file-->
            <File Id="VelvetPearlLotteryEXE" Name="Velvet Pearl Lottery.exe" Source="resources\Velvet Pearl Lottery.exe" KeyPath="yes">
              <Shortcut Id="startMenuShortcut" Directory="ProgramMenuDir" Name="Velvet Peral Lottery" WorkingDirectory="INSTALLDIR" Icon="ApplicationIcon.exe" IconIndex="0" Advertise="yes"/>
              <Shortcut Id="desktopShortcut" Directory="DesktopFolder" Name="Velvet Pearl Lottery" WorkingDirectory="INSTALLDIR" Icon="ApplicationIcon.exe" IconIndex="0" Advertise="yes"/>
            </File>
            <!--Associate .vplf files and give an icon in registry-->
            <ProgId Id="LotteryDataFileFormat" Description="Velvet Pearl Lottery data file" Advertise="yes" Icon="DatafileIcon.ico">
              <Extension Id="vplf">
                <Verb Id="open" Command="Open" Argument='"%1"' />
                <MIME Advertise="yes" ContentType="application/vplf" Default="yes"/>
              </Extension>
            </ProgId>
          </Component>   
          
         <!--Readme file-->
        <Component Id="Readme" Guid="*">
          <File Id="ReadmeTXT" Name="README.txt" Source="resources\README.txt"/>
        </Component>
          
        <!--License file-->
          <Component Id="License" Guid="*">
            <File Id="LicenseRTF" Name="LICENSE.rtf" Source="resources\license.rtf"/>
          </Component>
          
        </Directory>
			</Directory>

      <!--Flag the program dir for deletion on uninstall-->
      <Directory Id="ProgramMenuFolder" Name="Programs">
        <Directory Id="ProgramMenuDir" Name="Velvet Pearl Lottery">
          <Component Id="ProgramMenuDir" Guid="*">
            <RemoveFolder Id="ProgramMenuDir" On="uninstall"/>
            <RegistryValue Root="HKCU" Key="Software\[Manufacturer]\[ProductName]" Type="string" Value="" KeyPath="yes"/>
          </Component>
        </Directory>
      </Directory>

      <Directory Id="DesktopFolder" Name="Desktop" />
      
		</Directory>    
	</Fragment>

</Wix>